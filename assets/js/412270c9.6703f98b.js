"use strict";(globalThis.webpackChunkrock_docs=globalThis.webpackChunkrock_docs||[]).push([[1155],{8453(e,n,i){i.d(n,{R:()=>o,x:()=>l});var t=i(6540);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},9881(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"User Guides/configuration","title":"Configuration","description":"This guide provides detailed instructions on how to configure the ROCK environment to meet different usage requirements, including local development, testing, and production deployment.","source":"@site/versioned_docs/version-0.2.x/User Guides/configuration.md","sourceDirName":"User Guides","slug":"/User Guides/configuration","permalink":"/ROCK/docs/0.2.x/User Guides/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROCK/tree/master/docs/versioned_docs/version-0.2.x/User Guides/configuration.md","tags":[],"version":"0.2.x","lastUpdatedAt":1769744643000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"ROCK & ROLL Quick Start Guide","permalink":"/ROCK/docs/0.2.x/Getting Started/rockroll"},"next":{"title":"API Reference","permalink":"/ROCK/docs/0.2.x/References/api"}}');var r=i(4848),s=i(8453);const o={sidebar_position:4},l="Configuration",c={},d=[{value:"1. Environment Variable Configuration",id:"1-environment-variable-configuration",level:2},{value:"1.1 Runtime Environments",id:"11-runtime-environments",level:3},{value:"1.1.1 Docker Runtime Environment",id:"111-docker-runtime-environment",level:4},{value:"1.1.2 Local Runtime Environment",id:"112-local-runtime-environment",level:4},{value:"1.1.3 UV Runtime Environment",id:"113-uv-runtime-environment",level:4},{value:"1.1.4 PIP Runtime Environment",id:"114-pip-runtime-environment",level:4},{value:"1.1.5 Configuration Guide",id:"115-configuration-guide",level:4},{value:"1.2 Logging Configuration",id:"12-logging-configuration",level:3},{value:"2. Distributed Deployment Requirements",id:"2-distributed-deployment-requirements",level:2},{value:"Directory Structure Consistency",id:"directory-structure-consistency",level:4},{value:"Mounting Requirements",id:"mounting-requirements",level:4},{value:"Verifying Distributed Configuration",id:"verifying-distributed-configuration",level:4},{value:"Related Documents",id:"related-documents",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,r.jsx)(n.p,{children:"This guide provides detailed instructions on how to configure the ROCK environment to meet different usage requirements, including local development, testing, and production deployment."}),"\n",(0,r.jsx)(n.h2,{id:"1-environment-variable-configuration",children:"1. Environment Variable Configuration"}),"\n",(0,r.jsx)(n.p,{children:"ROCK supports configuring key parameters through environment variables. The main environment variables are as follows:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'export ROCK_BASE_URL=http://localhost:8080  # ROCK service base URL\nexport ROCK_LOG_LEVEL=INFO  # Log level\nexport ROCK_LOGGING_PATH=/path/to/logs  # Log file path, default None (output to console)\nexport ROCK_LOGGING_FILE_NAME=rocklet.log  # Log file name, default "rocklet.log", can be customized by admin like admin.log\nexport ROCK_LOGGING_LEVEL=INFO  # Log output level, default "INFO"\nexport ROCK_WORKER_ENV_TYPE=local  # Runtime environment type, options: local, docker, uv, pip\n'})}),"\n",(0,r.jsxs)(n.p,{children:["More environment variables can be found in ",(0,r.jsx)(n.code,{children:"rock/env_vars.py"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"11-runtime-environments",children:"1.1 Runtime Environments"}),"\n",(0,r.jsxs)(n.p,{children:["ROCK provides multiple different runtime environments to meet the needs of different scenarios, configured through the ",(0,r.jsx)(n.code,{children:"ROCK_WORKER_ENV_TYPE"})," environment variable. Each environment has different deployment requirements, performance characteristics and applicable scenarios. Each environment has its own unique advantages and limitations, and developers can choose the most suitable runtime environment according to their deployment needs."]}),"\n",(0,r.jsx)(n.h4,{id:"111-docker-runtime-environment",children:"1.1.1 Docker Runtime Environment"}),"\n",(0,r.jsxs)(n.p,{children:["The Docker runtime environment is suitable for Docker image environments where dependencies are pre-installed. This environment requires the ",(0,r.jsx)(n.code,{children:"/tmp/miniforge/bin/rocklet"})," executable to be directly available in the deployment environment."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mount Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/tmp/miniforge"})," - Contains pre-installed Python environment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/tmp/local_files"})," - Contains local files required for execution"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Start Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x /tmp/local_files/docker_run.sh && /tmp/local_files/docker_run.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Containerized deployment environments"}),"\n",(0,r.jsxs)(n.li,{children:["Already built custom Docker image containing ",(0,r.jsx)(n.code,{children:"rocklet"})]}),"\n",(0,r.jsx)(n.li,{children:"Suitable for production, fast startup"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Requires a custom Docker image containing ",(0,r.jsx)(n.code,{children:"/tmp/miniforge/bin/rocklet"})," executable"]}),"\n",(0,r.jsx)(n.li,{children:"Docker environment support"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"112-local-runtime-environment",children:"1.1.2 Local Runtime Environment"}),"\n",(0,r.jsx)(n.p,{children:"The local runtime environment directly uses the Python environment and project files of the current deployment. This environment requires the same operating system between the host and container to directly mount the virtual environment and Python interpreter."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mount Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"python_env_path"})," - Python environment path"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"project_root"})," - Project root directory"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:".venv"})," - Virtual environment directory (mounted as ",(0,r.jsx)(n.code,{children:"/tmp/miniforge"})," in container)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"local_files"})," - Local files required for execution"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Start Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x /tmp/local_files/docker_run.sh && /tmp/local_files/docker_run.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Development environments"}),"\n",(0,r.jsx)(n.li,{children:"Scenarios where host and target container use the same operating system"}),"\n",(0,r.jsx)(n.li,{children:"Need to quickly reuse existing Python environment"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Same operating system (host/container)"}),"\n",(0,r.jsxs)(n.li,{children:["Direct access to the currently deployed ",(0,r.jsx)(n.code,{children:".venv"})," virtual environment"]}),"\n",(0,r.jsx)(n.li,{children:"Python interpreter path compatibility"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"113-uv-runtime-environment",children:"1.1.3 UV Runtime Environment"}),"\n",(0,r.jsx)(n.p,{children:"The UV runtime environment only depends on the available ROCK project, but initialization is relatively slow and network requirements are higher. This environment is most suitable for scenarios without preconfigured environments. It rebuilds the rocklet environment from the original project. This is the recommended environment for Mac OS."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mount Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"project_root"})," - Project root directory (mounted as ",(0,r.jsx)(n.code,{children:"/tmp + project_root"})," in container)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"local_files"})," - Local files required for execution"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Start Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x /tmp/local_files/docker_run_with_uv.sh && /tmp/local_files/docker_run_with_uv.sh '<container_project_root>'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Mac OS"}),"\n",(0,r.jsx)(n.li,{children:"Cross-OS startup"}),"\n",(0,r.jsx)(n.li,{children:"Scenarios without preconfigured environment"}),"\n",(0,r.jsx)(n.li,{children:"No uv management Rock"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Advantages:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"No pre-built image required"}),"\n",(0,r.jsx)(n.li,{children:"Good cross-platform compatibility"}),"\n",(0,r.jsx)(n.li,{children:"Suitable for development and testing especially"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Limitations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initialization is relatively slow"}),"\n",(0,r.jsx)(n.li,{children:"Higher network requirements"}),"\n",(0,r.jsx)(n.li,{children:"Longer startup time"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"114-pip-runtime-environment",children:"1.1.4 PIP Runtime Environment"}),"\n",(0,r.jsx)(n.p,{children:"The PIP runtime environment uses pip to install required dependencies in the container. This environment is suitable for quick setup and scenarios where dependencies can be installed in the container. It is the default runtime environment. It does not require pre-built images containing dependencies, and manages Python packages directly through pip."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Mount Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"local_files"})," - Contains local files required for execution"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Start Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x /tmp/local_files/docker_run_with_pip.sh && /tmp/local_files/docker_run_with_pip.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROCK installation from PIP source"}),"\n",(0,r.jsx)(n.li,{children:"Fast testing of ROCK"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Advantages:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Simple deployment setup"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Limitations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Long dependency installation time"}),"\n",(0,r.jsx)(n.li,{children:"Requires network access to install dependency packages"}),"\n",(0,r.jsx)(n.li,{children:"Dependencies need to be installed each time on startup"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"115-configuration-guide",children:"1.1.5 Configuration Guide"}),"\n",(0,r.jsx)(n.p,{children:"Refer to the following selection guide for different use cases:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Scenario"}),(0,r.jsx)(n.th,{children:"Recommended Environment"}),(0,r.jsx)(n.th,{children:"Reason"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Production environment"}),(0,r.jsx)(n.td,{children:"Docker Runtime"}),(0,r.jsx)(n.td,{children:"Fast startup, stable performance"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Development environment, same OS"}),(0,r.jsx)(n.td,{children:"Local Runtime"}),(0,r.jsx)(n.td,{children:"Environment reuse, fast development cycle"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Mac development"}),(0,r.jsx)(n.td,{children:"UV Runtime"}),(0,r.jsx)(n.td,{children:"Best cross-platform compatibility support"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Cross-platform development"}),(0,r.jsx)(n.td,{children:"UV Runtime"}),(0,r.jsx)(n.td,{children:"Avoids environment compatibility issues"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fast testing"}),(0,r.jsx)(n.td,{children:"UV Runtime"}),(0,r.jsx)(n.td,{children:"Requires no pre-configuration"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PIP source installation"}),(0,r.jsx)(n.td,{children:"PIP Runtime"}),(0,r.jsx)(n.td,{children:"Install dependencies directly with pip"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["These runtime environments are configured through the ",(0,r.jsx)(n.code,{children:"ROCK_WORKER_ENV_TYPE"}),' environment variable, which can be set to "local", "docker", "uv" or "pip".']}),"\n",(0,r.jsx)(n.h3,{id:"12-logging-configuration",children:"1.2 Logging Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Regarding logging configuration, ROCK's logging system has the following characteristics:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The logging system cannot output to both file and console simultaneously. If ",(0,r.jsx)(n.code,{children:"ROCK_LOGGING_PATH"})," is set, logs will be output to the designated file, otherwise to console."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ROCK_LOGGING_LEVEL"})," is used to control the output log level, while ",(0,r.jsx)(n.code,{children:"ROCK_LOG_LEVEL"})," is used for general log level settings."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"2-distributed-deployment-requirements",children:"2. Distributed Deployment Requirements"}),"\n",(0,r.jsx)(n.p,{children:"Since ROCK supports distributed deployment, when running on different nodes of a Ray cluster, the following consistency requirements must be met:"}),"\n",(0,r.jsx)(n.h4,{id:"directory-structure-consistency",children:"Directory Structure Consistency"}),"\n",(0,r.jsx)(n.p,{children:"On all Ray nodes, the following directory structure must be completely consistent:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ROCK project repository directory"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:".venv"})," virtual environment directory"]}),"\n",(0,r.jsxs)(n.li,{children:["The base Python directory that ",(0,r.jsx)(n.code,{children:".venv"})," depends on"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"mounting-requirements",children:"Mounting Requirements"}),"\n",(0,r.jsx)(n.p,{children:"ROCK's startup depends on mounting the ROCK project and the corresponding base Python environment, requiring consistency in multi-machine environments:"}),"\n",(0,r.jsx)(n.h4,{id:"verifying-distributed-configuration",children:"Verifying Distributed Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Distributed deployment configuration can be verified through the following methods:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check directory consistency on all nodes\nls -la /path/to/rock\nls -la /path/to/rock/.venv\nls -la $ROCK_PYTHON_ENV_PATH\n\n# Verify Python environment availability\n$ROCK_PYTHON_ENV_PATH/bin/python --version\n\n# Check environment variable settings on all nodes\necho $ROCK_PYTHON_ENV_PATH\necho $ROCK_PROJECT_ROOT\n"})}),"\n",(0,r.jsx)(n.h2,{id:"related-documents",children:"Related Documents"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/ROCK/docs/0.2.x/Getting%20Started/quickstart",children:"Quick Start Guide"})," - Learn how to quickly set up the ROCK environment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/ROCK/docs/0.2.x/References/api",children:"API Documentation"})," - View sandbox-related API interfaces"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/ROCK/docs/0.2.x/References/Python%20SDK%20References/python_sdk",children:"Python SDK Documentation"})," - Learn how to use the SDK to configure sandboxes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/ROCK/docs/0.2.x/Getting%20Started/installation",children:"Installation Guide"})," - Detailed information about ROCK installation and setup"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);