"use strict";(globalThis.webpackChunkrock_docs=globalThis.webpackChunkrock_docs||[]).push([[659],{1972(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"References/Python SDK References/sandbox","title":"Sandbox SDK Reference","description":"arun","source":"@site/versioned_docs/version-1.0.x/References/Python SDK References/sandbox.md","sourceDirName":"References/Python SDK References","slug":"/References/Python SDK References/sandbox","permalink":"/ROCK/docs/References/Python SDK References/sandbox","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROCK/tree/master/docs/versioned_docs/version-1.0.x/References/Python SDK References/sandbox.md","tags":[],"version":"1.0.x","lastUpdatedAt":1769395797000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Python SDK Reference","permalink":"/ROCK/docs/References/Python SDK References/python_sdk"},"next":{"title":"Release Notes","permalink":"/ROCK/docs/Release Notes/"}}');var o=s(4848),r=s(8453);const i={},a="Sandbox SDK Reference",d={},l=[{value:"<code>arun</code>",id:"arun",level:2},{value:"<code>read_file_by_line_range</code>",id:"read_file_by_line_range",level:2},{value:"Usage Examples:",id:"usage-examples",level:3}];function c(e){const n={br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"sandbox-sdk-reference",children:"Sandbox SDK Reference"})}),"\n",(0,o.jsx)(n.h2,{id:"arun",children:(0,o.jsx)(n.code,{children:"arun"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"arun()"})," provides two knobs to control how ",(0,o.jsx)(n.code,{children:"nohup"})," output is handled:"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"response_limited_bytes_in_nohup"})})," ",(0,o.jsx)(n.em,{children:"(integer type)"}),(0,o.jsx)(n.br,{}),"\n","Caps the number of characters returned from the nohup output file. Useful when you still need to stream some logs back but want an upper bound (default ",(0,o.jsx)(n.code,{children:"None"})," = no cap)."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"ignore_output"})})," ",(0,o.jsxs)(n.em,{children:["(bool, default ",(0,o.jsx)(n.code,{children:"False"}),")"]}),(0,o.jsx)(n.br,{}),"\n","When set to ",(0,o.jsx)(n.code,{children:"True"}),", ",(0,o.jsx)(n.code,{children:"arun()"})," skips reading the nohup output file entirely. The command still runs to completion and writes logs to ",(0,o.jsx)(n.code,{children:"/tmp/tmp_<timestamp>.out"}),", but the SDK immediately returns a lightweight hint telling agents where to fetch the logs later (via ",(0,o.jsx)(n.code,{children:"read_file"}),', download APIs, or custom commands). This fully decouples "execute command" from "inspect logs". The response also includes the ',(0,o.jsx)(n.strong,{children:"file size"})," to help users decide whether to download directly or read in chunks."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from rock.sdk.sandbox.client import Sandbox\nfrom rock.sdk.sandbox.config import SandboxConfig\nfrom rock.sdk.sandbox.request import CreateBashSessionRequest\n\nconfig = SandboxConfig(\n    image=f"{image}",\n    xrl_authorization=f"{xrl_authorization}",\n    user_id=f"{user_id}",\n    cluster=f"{cluster}",\n)\nsandbox = Sandbox(config)\n\nsession = sandbox.create_session(CreateBashSessionRequest(session="bash-1"))\n\n# Example 1: limit the returned logs to 1024 characters\nresp_limited = asyncio.run(\n    sandbox.arun(\n        cmd="cat /tmp/test.txt",\n        mode="nohup",\n        session="bash-1",\n        response_limited_bytes_in_nohup=1024,\n    )\n)\n\n# Example 2: skip collecting logs; agent will download/read them later\nresp_detached = asyncio.run(\n    sandbox.arun(\n        cmd="bash run_long_job.sh",\n        mode="nohup",\n        session="bash-1",\n        ignore_output=True,\n    )\n)\nprint(resp_detached.output)\n# Command executed in nohup mode without streaming the log content.\n# Status: completed\n# Output file: /tmp/tmp_xxx.out\n# File size: 15.23 MB\n# Use Sandbox.read_file(...), download APIs, or run \'cat /tmp/tmp_xxx.out\' ...\n'})}),"\n",(0,o.jsx)(n.h2,{id:"read_file_by_line_range",children:(0,o.jsx)(n.code,{children:"read_file_by_line_range"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Description"}),": Asynchronously reads file content by line range, with built-in support for automatic chunking and session management. Key features include:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Automatic chunked reading for large files"}),"\n",(0,o.jsx)(n.li,{children:"Automatic total line count estimation"}),"\n",(0,o.jsx)(n.li,{children:"Built-in retry mechanism (3 retries by default)"}),"\n",(0,o.jsx)(n.li,{children:"Input parameter validation"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"usage-examples",children:"Usage Examples:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'# Read the entire file\nresponse = await read_file_by_line_range("example.txt")\n\n# Read a specific line range (1-based, inclusive)\nresponse = await read_file_by_line_range("example.txt", start_line=1, end_line=2000)\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>i,x:()=>a});var t=s(6540);const o={},r=t.createContext(o);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);