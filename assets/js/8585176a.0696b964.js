"use strict";(globalThis.webpackChunkrock_docs=globalThis.webpackChunkrock_docs||[]).push([[3788],{5382(n,e,o){o.r(e),o.d(e,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"References/Python SDK References/python_sdk","title":"Python SDK Reference","description":"This guide provides detailed information on how to use the ROCK SDK for development, including sandbox environment management and GEM environment interaction.","source":"@site/versioned_docs/version-1.0.x/References/Python SDK References/python_sdk.md","sourceDirName":"References/Python SDK References","slug":"/References/Python SDK References/python_sdk","permalink":"/ROCK/docs/1.0.x/References/Python SDK References/python_sdk","draft":false,"unlisted":false,"editUrl":"https://github.com/alibaba/ROCK/tree/master/docs/versioned_docs/version-1.0.x/References/Python SDK References/python_sdk.md","tags":[],"version":"1.0.x","lastUpdatedAt":1769567739000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Sandbox Agent\uff08Experimental\uff09","permalink":"/ROCK/docs/1.0.x/References/sandbox-agent"},"next":{"title":"Sandbox SDK Reference","permalink":"/ROCK/docs/1.0.x/References/Python SDK References/sandbox"}}');var t=o(4848),i=o(8453);const s={sidebar_position:2},a="Python SDK Reference",d={},c=[{value:"1. Overview",id:"1-overview",level:2},{value:"2. Sandbox SDK",id:"2-sandbox-sdk",level:2},{value:"2.1 Basic Sandbox Operations",id:"21-basic-sandbox-operations",level:3},{value:"2.2 Sandbox Group Management",id:"22-sandbox-group-management",level:3},{value:"2.3 Configuration Example",id:"23-configuration-example",level:3},{value:"2.4 Sandbox Speedup Configuration",id:"24-sandbox-speedup-configuration",level:3},{value:"Supported Speedup Types",id:"supported-speedup-types",level:4},{value:"Complete Example",id:"complete-example",level:4},{value:"Important Notes",id:"important-notes",level:4},{value:"3. GEM SDK",id:"3-gem-sdk",level:2},{value:"3.1 Python SDK Approach",id:"31-python-sdk-approach",level:3},{value:"Related Documents",id:"related-documents",level:2}];function p(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"python-sdk-reference",children:"Python SDK Reference"})}),"\n",(0,t.jsx)(e.p,{children:"This guide provides detailed information on how to use the ROCK SDK for development, including sandbox environment management and GEM environment interaction."}),"\n",(0,t.jsx)(e.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,t.jsx)(e.p,{children:"ROCK SDK provides developers with convenient Python interfaces to use ROCK platform features, including sandbox environment management and GEM environment interaction."}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Important Note"}),": Before using the SDK, ensure that the ROCK Admin service is running. You can start it with the following command:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"rock admin start\n"})}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"2-sandbox-sdk",children:"2. Sandbox SDK"}),"\n",(0,t.jsx)(e.h3,{id:"21-basic-sandbox-operations",children:"2.1 Basic Sandbox Operations"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import asyncio\n\nfrom rock.actions import CreateBashSessionRequest\nfrom rock.sdk.sandbox.client import Sandbox\nfrom rock.sdk.sandbox.config import SandboxConfig\n\nasync def run_sandbox():\n    """Run sandbox demo with admin server requirement.\n\n    NOTE: This demo requires the admin server to be running for proper execution.\n    Make sure to start the admin server before running this script.\n    Default admin server port is 8080.\n    """\n    # Create sandbox configuration\n    config = SandboxConfig(image="python:3.11", memory="8g", cpus=2.0)\n\n    # Create sandbox instance\n    sandbox = Sandbox(config)\n\n    # Start sandbox (connects to admin server)\n    await sandbox.start()\n\n    # Create session in sandbox for command execution\n    await sandbox.create_session(CreateBashSessionRequest(session="bash-1"))\n\n    # Execute command in sandbox session\n    result = await sandbox.arun(cmd="echo Hello ROCK", session="bash-1")\n    print("\\n" + "*" * 50 + "\\n" + result.output + "\\n" + "*" * 50 + "\\n")\n\n    # Stop and clean up sandbox resources\n    await sandbox.stop()\n\nif __name__ == "__main__":\n    # Ensure admin server is running before executing\n    print("IMPORTANT: Make sure the admin server is running before executing this demo!")\n    print("Start the admin server with: rock admin start")\n    asyncio.run(run_sandbox())\n'})}),"\n",(0,t.jsx)(e.h3,{id:"22-sandbox-group-management",children:"2.2 Sandbox Group Management"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'from rock.sdk.sandbox.config import SandboxGroupConfig\n\n# Create sandbox group configuration\nconfig = SandboxGroupConfig(\n    image="python:3.11",\n    size=4,  # Create 4 sandboxes\n    start_concurrency=2,  # Concurrency level for startup is 2\n)\n\n# Create and start sandbox group\nsandbox_group = SandboxGroup(config)\nawait sandbox_group.start()\n\n# Batch operations\nfor sandbox in sandbox_group.sandbox_list:\n    await sandbox.run_in_session(Action(session="default", command="echo Hello"))\n\n# Batch stop\nawait sandbox_group.stop()\n'})}),"\n",(0,t.jsx)(e.h3,{id:"23-configuration-example",children:"2.3 Configuration Example"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'config = SandboxConfig(\n    image="python:3.11",\n    auto_clear_seconds=60 * 20,\n    experiment_id="test",\n)\n'})}),"\n",(0,t.jsx)(e.h3,{id:"24-sandbox-speedup-configuration",children:"2.4 Sandbox Speedup Configuration"}),"\n",(0,t.jsx)(e.p,{children:"ROCK provides sandbox network acceleration capabilities, supporting configuration of APT, PIP, and GitHub mirror sources to improve package download speeds in restricted network environments."}),"\n",(0,t.jsx)(e.h4,{id:"supported-speedup-types",children:"Supported Speedup Types"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"APT Mirror Configuration"})}),"\n",(0,t.jsx)(e.p,{children:"Configure APT package manager mirror sources for faster Debian/Ubuntu package downloads."}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'from rock.sdk.sandbox.speedup import SpeedupType\n\n# Configure APT mirror\nawait sandbox.network.speedup(\n    speedup_type=SpeedupType.APT,\n    speedup_value="http://mirrors.cloud.aliyuncs.com"\n)\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"PIP Mirror Configuration"})}),"\n",(0,t.jsx)(e.p,{children:"Configure Python package index mirrors for faster pip installations."}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# HTTP mirror\nawait sandbox.network.speedup(\n    speedup_type=SpeedupType.PIP,\n    speedup_value="http://mirrors.cloud.aliyuncs.com"\n)\n\n# HTTPS mirror\nawait sandbox.network.speedup(\n    speedup_type=SpeedupType.PIP,\n    speedup_value="https://mirrors.aliyun.com"\n)\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"GitHub Acceleration"})}),"\n",(0,t.jsx)(e.p,{children:"Configure GitHub IP acceleration by adding custom DNS resolution entries."}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'await sandbox.network.speedup(\n    speedup_type=SpeedupType.GITHUB,\n    speedup_value="11.11.11.11"\n)\n'})}),"\n",(0,t.jsx)(e.h4,{id:"complete-example",children:"Complete Example"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'from rock.sdk.sandbox.speedup import SpeedupType\nfrom rock.actions import RunMode\n\nasync def setup_sandbox_with_speedup():\n    """Create sandbox and configure acceleration"""\n    config = SandboxConfig(image="python:3.11")\n    sandbox = Sandbox(config)\n    \n    await sandbox.start()\n    \n    # Configure acceleration (before installing packages)\n    await sandbox.network.speedup(\n        speedup_type=SpeedupType.APT,\n        speedup_value="http://mirrors.cloud.aliyuncs.com"\n    )\n    \n    await sandbox.arun(cmd="apt-get update && apt-get install -y git", mode=RunMode.NOHUP)\n\n    await sandbox.network.speedup(\n        speedup_type=SpeedupType.PIP,\n        speedup_value="https://mirrors.aliyun.com"\n    )\n\n    # Speedup does not automatically install PIP, it only configures mirror sources for acceleration\n    await sandbox.arun(cmd="pip install numpy", mode=RunMode.NOHUP)\n\n    # GitHub can be accelerated through mirror IP\n    await sandbox.network.speedup(\n        speedup_type=SpeedupType.GITHUB,\n        speedup_value="11.11.11.11"\n    )\n\n    return sandbox\n'})}),"\n",(0,t.jsx)(e.h4,{id:"important-notes",children:"Important Notes"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Configuration Order"}),": Configure speedup before installing packages"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"HTTPS vs HTTP"}),": HTTPS mirrors don't require trusted-host configuration for PIP"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"GitHub IP"}),": Different regions may require different IPs for optimal performance"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Persistence"}),": Configurations persist within the sandbox lifecycle"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Multiple Calls"}),": Subsequent speedup calls will override previous configurations"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"PIP Installation"}),": The speedup feature only configures mirror sources and does not automatically install PIP"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"3-gem-sdk",children:"3. GEM SDK"}),"\n",(0,t.jsx)(e.h3,{id:"31-python-sdk-approach",children:"3.1 Python SDK Approach"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import random\nimport rock\n\ndef main():\n    """Main function to run the Sokoban demo with admin server requirement.\n\n    NOTE: This demo requires the admin server to be running for proper execution.\n    Make sure to start the admin server before running this script.\n    """\n    # Create environment using GEM standard interface\n    # NOTE: This requires the admin server to be running\n    env_id = "game:Sokoban-v0-easy"\n    env = rock.make(env_id)\n\n    # Reset environment to initial state\n    observation, info = env.reset(seed=42)\n    print(\n        "\\n"\n        + "=" * 80\n        + "\\nInitial Observation:\\n"\n        + str(observation)\n        + "\\n\\nInitial Info:\\n"\n        + str(info)\n        + "\\n"\n        + "=" * 80\n        + "\\n"\n    )\n\n    # Run environment loop until termination\n    step_count = 0\n    while True:\n        # Interactive environment operation with random actions\n        action = f"\\\\boxed{{{random.choice([\'up\', \'left\', \'right\', \'down\'])}}}"\n        observation, reward, terminated, truncated, info = env.step(action)\n\n        step_count += 1\n        print(\n            "\\n"\n            + "-" * 80\n            + f"\\nStep {step_count} - Action: {action}\\nReward: {reward}\\nObservation:\\n{observation}\\nInfo: {info}\\nTerminated: {terminated}, Truncated: {truncated}\\n"\n            + "-" * 80\n            + "\\n"\n        )\n\n        # Check if environment has reached terminal state\n        if terminated or truncated:\n            print("\\n" + "=" * 80 + "\\nEpisode finished!\\n" + "=" * 80 + "\\n")\n            break\n\n    # Clean up environment resources\n    env.close()\n\nif __name__ == "__main__":\n    # Ensure admin server is running before executing\n    print(\n        "\\n"\n        + "=" * 80\n        + "\\nIMPORTANT: Make sure the admin server is running before executing this demo!\\nStart the admin server with: rock admin start\\n"\n        + "=" * 80\n        + "\\n"\n    )\n    main()\n'})}),"\n",(0,t.jsx)(e.h2,{id:"related-documents",children:"Related Documents"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/ROCK/docs/1.0.x/Getting%20Started/quickstart",children:"Quick Start Guide"})," - Learn how to quickly get started with the ROCK SDK"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/ROCK/docs/1.0.x/References/api",children:"API Documentation"})," - View the underlying API interfaces encapsulated by the SDK"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/ROCK/docs/1.0.x/User%20Guides/configuration",children:"Configuration Guide"})," - Learn about SDK-related configuration options"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"/ROCK/docs/1.0.x/Getting%20Started/installation",children:"Installation Guide"})," - Detailed information about ROCK installation and setup"]}),"\n"]})]})}function l(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},8453(n,e,o){o.d(e,{R:()=>s,x:()=>a});var r=o(6540);const t={},i=r.createContext(t);function s(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);